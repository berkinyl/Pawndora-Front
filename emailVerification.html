<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Basic -->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <!-- Mobile Metas -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <!-- Site Metas -->
  <meta name="keywords" content="login, pawndora, pet adoption" />
  <meta name="description" content="Login to Pawndora to find your perfect pet or manage your pet posts." />
  <meta name="author" content="Pawndora Team" />
  <link rel="shortcut icon" href="images/pawnPink.png" type="image/x-icon">

  <title>Login - Pawndora</title>

  <!-- bootstrap core css -->
  <link rel="stylesheet" type="text/css" href="css/bootstrap.css" />

  <!-- Custom styles for this template -->
  <link href="css/style.css" rel="stylesheet" />
  <!-- responsive style -->
  <link href="css/responsive.css" rel="stylesheet" />
</head>

<body>
  <div class="hero_area">
    <!-- Header section starts -->
    <header class="header_section">
      <nav class="navbar navbar-expand-lg custom_nav-container">
        <a class="navbar-brand" href="index.html">
          <span class="brand_pawndora">
            Pawndora
          </span>
        </a>
      </nav>
    </header>

      <!-- end header section -->

    <section class="verification_section">
      <div class="container">
        <div class="verification_box">
          <h2>Verify your email</h2>
          <p>
            Check your email for a verification code. It may be in your junk folder. Allow up to 5 minutes to receive the email.
          </p>
          <div class="email_info">
            Not john.doe@gmail.com? <a href="#" class="change_email">Change</a>
          </div>
          <form id="verificationForm">
            <div class="code_inputs">
              <input type="text" maxlength="1" class="verification_code" required>
              <input type="text" maxlength="1" class="verification_code" required>
              <input type="text" maxlength="1" class="verification_code" required>
              <input type="text" maxlength="1" class="verification_code" required>
              <input type="text" maxlength="1" class="verification_code" required>
              <input type="text" maxlength="1" class="verification_code" required>
            </div>
            <button type="submit" class="btn verify_btn">Verify</button>
          </form>
          <p class="resend_text">
            Didnâ€™t receive a code? <a href="#" class="resend_link">Try again</a>
          </p>
        </div>
      </div>
    </section>
        <!-- Footer Section -->
      <footer class="footer_section">
        <div class="container">
          <p>
            &copy; <span id="displayYear"></span> All Rights Reserved by
            <a href="#">Pawndora</a>
          </p>
        </div>
      </footer>

  </div>

  <!-- JavaScript -->
  <script src="js/emailVerification.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const verificationForm = document.getElementById("verificationForm");
      const resendForm = document.getElementById("resendForm");
      const inputs = document.querySelectorAll(".verification_code");
  
      // Handle verification code input navigation
      inputs.forEach((input, index) => {
        input.addEventListener("input", (event) => {
          const currentInput = event.target;
          const nextInput = inputs[index + 1]; // Get the next input field
  
          // Move to the next input if current is filled
          if (currentInput.value.length === currentInput.maxLength && nextInput) {
            nextInput.focus();
          }
        });
  
        input.addEventListener("keydown", (event) => {
          const previousInput = inputs[index - 1];
  
          // Move to the previous input on Backspace if current is empty
          if (event.key === "Backspace" && !input.value && previousInput) {
            previousInput.focus();
          }
        });
      });
  
      // Handle verification code submission
      verificationForm.addEventListener("submit", (event) => {
        event.preventDefault();
  
        const code = Array.from(inputs)
          .map((input) => input.value)
          .join(""); // Combine all input values into one string
  
        fetch("/verifyCode", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ code }),
        })
          .then((response) => response.json())
          .then((data) => {
            if (data.success) {
              alert("Email verified successfully!");
              window.location.href = "index.html"; // Redirect to the homepage
            } else {
              alert("Invalid verification code. Please try again.");
            }
          })
          .catch((error) => {
            console.error("Verification error:", error);
            alert("An error occurred. Please try again.");
          });
      });
  
      // Handle resend email
      resendForm.addEventListener("submit", (event) => {
        event.preventDefault();
  
        fetch("/resendVerificationEmail", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
        })
          .then((response) => response.json())
          .then((data) => {
            if (data.success) {
              alert("Verification email has been resent. Please check your inbox.");
            } else {
              alert("Failed to resend email: " + data.message);
            }
          })
          .catch((error) => {
            console.error("Error resending email:", error);
            alert("An error occurred. Please try again later.");
          });
      });
    });
  </script>
  
 
</body>

</html>

